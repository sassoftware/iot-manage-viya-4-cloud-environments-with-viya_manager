<a name="top"></a>

##### [&#11013;](../../README.md) Back
## -Install

Syntax:
```
Viya_Manager -install -cluster <cluster name> -provider <AZURE | AWS | GCP | K8S> -order <order number> -cadence <Viya cadence> -type <LTS | STABLE> -email <email> [ -template <file name> ] [ -tenant_list <file name> [ -onboard ]] [ -domain <domain name> ] [ -v | -verbose ] ]
```
Where:
>>>
- **cluster name** is the name of the cluster being created or modified
- **provider** is one among **AZURE**, **AWS**, or **GCP**
- **order** is the SAS order number
- **cadence** is the cadence for the order
- **type** is either **LTS** (long term support) or **STABLE**
- **email** is the email of a user authorized to install the order
- **template** is a template file in $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Templates containing the list of settings to be applied to Viya. Default is viya.cfg.template
- **tenant_list** is the file that stores the list of tenant IDs and optional passwords for the **sasprovider** ID when installing Viya in multi-tenant mode. The file must be created in $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Credentials
- **onboard** on-boards all tenant IDs and their associated CAS controllers
- **domain** is the domain name for the Viya ingress and monitoring services
- **-v | --verbose** enables or suppresses the output of the command to the log
>>>
**-Install** is used to deploy Viya 4 on a previously created Kubernetes cluster. The command can take several minutes to complete. It uses the **$HOME/\<Viya_Manager-root-folder\>/Cloud-Providers/\<provider\>/Templates/viya.cfg.template** file to create the configuration for the SAS Viya 4 Deployment tool which downloads and installs the SAS order. At the end of the execution, the IP address and host name needed to access Viya are returned.

The command installs the asset, license, and certificates files for the order inside the **$HOME/\<Viya_Manager-root-folder\>/Cloud-Providers/<provider>/Clusters/\<cluster name\>/Orders** and **$HOME/\<Viya_Manager-root-folder\>/Cloud-Providers/\<provider\>/Clusters/\<cluster name\>/License-and-certificates** directories. The files are required when applying changes to the Viya environment, either manually through a series of individual commands, or via the Deployment Operator. Viya_Manager provides scripts to automate both types of deployment. The scripts can be found in **$HOME/\<Viya_Manager-root-folder\>/Management/Deployment/Manual** and **$HOME/\<Viya_Manager-root-folder\>/Management/Deployment/Operator**. Please refer to the README.md file in each folder for more details on the scripts. As to the Deployment Operator, its installation and/or removal can be controlled through a Viya_Manager option described later in the document.

**Example:**
```
Viya_Manager -install -cluster viya-iot-azure -provider azure -order 9CNK14 -cadence 2021.2.3 -type stable -email john.doe@sas.com -v
```
Below is an excerpt from the output generated by the command:
```
- Installing Viya...2022/02/06 21:48:20 INFO: using config file: /Keys/viya4-orders-cli.yaml
OrderNumber: 9CNK14
AssetName: certificates
AssetReqURL: https://api.sas.com/mysas/orders/9CNK14/certificates
AssetLocation: /License-and-certificates/SASViyaV4_9CNK14_certs.zip
Cadence:
CadenceRelease:
2022/02/06 21:48:21 INFO: using config file: /Keys/viya4-orders-cli.yaml
OrderNumber: 9CNK14
AssetName: license
AssetReqURL: https://api.sas.com/mysas/orders/9CNK14/cadenceNames/stable/cadenceVersions/2021.2.3/license
AssetLocation: /License-and-certificates/SASViyaV4_9CNK14_stable_2021.2.3_license_2022-01-20T155048.jwt
Cadence: STABLE 2021.2.3
CadenceRelease:
2022/02/06 21:48:22 INFO: using config file: /Keys/viya4-orders-cli.yaml
OrderNumber: 9CNK14
AssetName: deploymentAssets
AssetReqURL: https://api.sas.com/mysas/orders/9CNK14/cadenceNames/stable/cadenceVersions/2021.2.3/deploymentAssets
AssetLocation: /Orders/SASViyaV4_9CNK14_stable_2021.2.3_20220205.1644033355437_deploymentAssets_2022-02-06T214831.tgz
Cadence: Stable 2021.2.3
CadenceRelease: 20220205.1644033355437

- Re-setting default storage class...
- Creating viya configuration file for viya-iot-azure...
- Customizing viya configuration file for viya-iot-azure...
...
Sunday 06 February 2022  21:57:47 +0000 (0:00:00.257)       0:08:49.340 *******
===============================================================================
vdm : manifest - deploy ----------------------------------------------- 184.60s
vdm : prereqs - cluster-local deploy ----------------------------------- 56.32s
vdm : manifest - deploy update ----------------------------------------- 46.93s
vdm : kustomize - Generate deployment manifest ------------------------- 35.33s
baseline : Deploy ingress-nginx ---------------------------------------- 34.28s
baseline : Deploy cert-manager ----------------------------------------- 31.46s
baseline : Deploy metrics-server --------------------------------------- 24.44s
vdm : assets - Extract downloaded assets ------------------------------- 19.55s
vdm : prereqs - cluster-wide ------------------------------------------- 18.03s
baseline : Deploy nfs-subdir-external-provisioner ---------------------- 14.94s
vdm : prereqs - cluster-api --------------------------------------------- 8.84s
baseline : Deploy cluster-autoscaler ------------------------------------ 7.71s
jump-server : jump-server - lookup groups ------------------------------- 4.59s
jump-server : jump-server - create folders ------------------------------ 3.83s
vdm : Download viya4-orders-cli ----------------------------------------- 3.42s
baseline : Remove deprecated nfs-client-provisioner --------------------- 3.09s
baseline : Remove deprecated efs-provisioner namespace ------------------ 2.95s
vdm : copy - VDM transformers ------------------------------------------- 2.70s
vdm : copy - VDM generators --------------------------------------------- 2.64s
vdm : Create namespace -------------------------------------------------- 1.80s

- Task completed.
- Viya installed successfully. It should be up and running in about 1 hour.
- If necessary, add the following information to your Network Address Management Entry System to access Viya:
	- IP Address ..: 34.198.109.253
	- Host ........: viya-iot-azure.unx.sas.com
```
[&#11014;](#top) Top
### Multi-Tenancy

Installing Viya in multi-tenant mode is a two-step process. The first part deploys the software while enabling multi-tenancy. This is done by running Viya_Manager with a command similar to the following:
```
Viya_Manager -install -cluster viya-iot-azure -provider azure -order 9CNK14 -cadence 2022.09 -type stable -email john.doe@sas.com -tenant_list tenants.lst -v
```
The output generated by the command looks identical to the one shown in the example in the previous section with one exception. The IP address for Viya shows as many host associations as the number of tenant IDs to create:
```
...
- Task completed.
- Viya installed successfully. It should be up and running in about 1 hour.
- If necessary, add the following information to your Network Address Management Entry System to access Viya:
	- IP Address ..: 34.198.109.253
	- Host ........: viya-iot-azure.unx.sas.com
	- Host ........: tenant1-viya-iot-azure.unx.sas.com
	- Host ........: tenant2-viya-iot-azure.unx.sas.com
	...
	- Host ........: tenantn-viya-iot-azure.unx.sas.com
```
Once multi-tenancy is enabled, tenant IDs and their CAS controllers are on-boarded executing Viya_Manager as shown in the example below:
```
Viya_Manager -install -cluster viya-iot-azure -provider azure -order 9CNK14 -cadence 2022.09 -type stable -email john.doe@sas.com -tenant_list tenants.lst -onboard -v
```
Upon completion, the cluster will show individual CAS controllers for every on-boarded tenant ID. At that point you can proceed with the customization of the environment for each tenant.

[&#11014;](#top) Top
### About Software Updates
```
In multi-tenancy, software updates currently require you to re-onboard your tenants.
```
