##### [&#11013;](../../README.md) Back
## -Apply

Syntax:
```
Viya_Manager -apply -cluster <cluster name> -provider <AZURE | AWS | GCP | K8S> [ -location <location> ] [ -credentials <file name> ] [ -template <file name> ] [ -inventory <file name> ] [ -vars <file name> ] [ -v | -verbose ]
```
Where:
>>>
- **cluster name** is the name of the cluster being created or modified
- **provider** is one among **AZURE**, **AWS**, or **GCP**
- **location** is a valid region where the cluster is located. Default is ‘eastus’ for Azure, and ‘us-east-1’ for AWS
- **credentials** is the cloud provider's credentials file in $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Credentials. Default is <provider>-credentials.
- **template** is a template file in $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Templates containing the list of settings to be applied to the cluster. Default is <provider>.cfg.template.
- **inventory** for Open Source Kubernetes (K8S), it specifies the template file with the FQDNs/IP addresses of the cluster's nodes. Default is k8s.inventory.template. Ignored for all other providers
- **vars** for Open Source Kubernetes (K8S), it specifies the template file with VSPHERE-related options. Default is k8s.ansible-vars.template. Ignored for all other providers
- **-v | --verbose** enables or suppresses the output of the command to the log
>>>
**-Apply** is used to either create or modify the Kubernetes cluster. It can take several minutes to complete depending on the complexity of the environment. Its execution creates the KUBECONFIG file to access the cluster in the $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Clusters/\<cluster name\> folder, and merges it with the KUBECONFIG file of the person running the command to make it easy for the same user to issue commands against the cluster through the **kubectl** interface. If the cluster is configured with a Jump and/or NFS server with a public IP address, **-apply** generates the identity key in PEM format to access the machines. The file has the same name as the cluster, and is stored in the $HOME/Viya_Manager/Cloud-Providers/\<provider\>/Clusters/\<cluster name>\/Keys folder.

**Example:**
```
Viya_Manager -apply -cluster viya-iot-azure -provider azure -v
```
Below is an excerpt from the output generated by the command:
```
- Creating cluster infrastructure for viya-iot-azure...
- Creating configuration folder for viya-iot-azure...
- Creating credentials folder for viya-iot-azure...
- Creating azure configuration file for viya-iot-azure...
- Customizing azure configuration file for viya-iot-azure...
...
Apply complete! Resources: 33 added, 0 changed, 0 destroyed.

Output:

aks_cluster_node_username = "clusterUser_viya-iot-azure-rg_viya-iot-azure-aks"
aks_cluster_password = <sensitive>
aks_host = "https://viya-iot-azure-aks-fc730c45.hcp.eastus.azmk8s.io:443"
cluster_api_mode = "public"
cluster_name = "viya-iot-azure-aks"
cluster_node_pool_mode = "default"
jump_admin_username = "jumpuser"
jump_private_ip = "192.168.2.5"
jump_public_ip = "40.121.10.98"
jump_rwx_filestore_path = "/viya-share"
kube_config = <sensitive>
location = "eastus"
nat_ip = "20.88.163.138"
nfs_admin_username = "nfsuser"
nfs_private_ip = "192.168.2.4"
nfs_public_ip = "40.121.15.251"
prefix = "viya-iot-azure"
provider = "azure"
provider_account = "iot"
rwx_filestore_endpoint = "192.168.2.4"
rwx_filestore_path = "/export"

- Task completed.
- Cluster added to KUBECONFIG file. Switched to context "viya-iot-azure-aks".

- Re-setting default storage class...
- To access the Jump and NFS boxes via ssh, use the /myuser/Viya_Manager/Cloud-Providers/azure/Clusters/viya-iot-azure/Keys/viya-iot-azure identity key.
-    Example: ssh -i /root/Viya_Manager/Cloud-Providers/azure/Clusters/viya-iot-azure/Keys/viya-iot-azure <user> viya-iot-azure azure
- Alternatively, you can use the ssh_m utility that comes with Viya_Manager.
-    Example: ssh_m <user> viya-iot-azure azure
- Where <user> is the username specified through the jump_vm_admin or the nfs_vm_admin options in the gcp configuration template.
- Done!
```
